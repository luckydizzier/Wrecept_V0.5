<Window x:Class="Wrecept.Views.InvoiceView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Számlák kezelése" Height="600" Width="900"
        WindowStartupLocation="CenterOwner">
    <Window.InputBindings>
        <KeyBinding Key="S" Modifiers="Control" Command="{Binding SaveCommand}" />
        <KeyBinding Key="Escape" Command="{Binding ExitToListCommand}" />
    </Window.InputBindings>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <!-- Sidebar -->
        <StackPanel Grid.Column="0" Margin="10" >
            <TextBox x:Name="SearchBox" x:Uid="Search" PlaceholderText="Keresés számlaszám, dátum…" Margin="0,0,0,10" />
            <DatePicker x:Name="FromDate" Margin="0,0,0,5" />
            <DatePicker x:Name="ToDate" Margin="0,0,0,10" />
            <ComboBox x:Name="SupplierFilter" Margin="0,0,0,10" />
            <DataGrid x:Name="InvoiceList" ItemsSource="{Binding Invoices}" SelectedItem="{Binding SelectedInvoice, Mode=TwoWay}"
                      AutoGenerateColumns="False" Height="300" >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Számlaszám" Binding="{Binding SerialNumber}" />
                    <DataGridTextColumn Header="Dátum" Binding="{Binding IssueDate}" />
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>

        <!-- Main content -->
        <Grid Grid.Column="1" Margin="10" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <!-- Header grid -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Szállító" Margin="0,0,5,5"/>
                <TextBox Grid.Column="1" Text="{Binding Invoice.Supplier.Name}" TabIndex="0" />
                <TextBlock Grid.Column="2" Text="Cím" Margin="10,0,5,5"/>
                <TextBox Grid.Column="3" Text="{Binding Invoice.Supplier.Address}" TabIndex="1" />
                <TextBlock Grid.Column="0" Grid.Row="1" Text="Adószám" Margin="0,5,5,5"/>
                <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding Invoice.Supplier.TaxNumber}" TabIndex="2" />
                <TextBlock Grid.Column="2" Grid.Row="1" Text="Számlaszám" Margin="10,5,5,5"/>
                <TextBox Grid.Column="3" Grid.Row="1" Text="{Binding Invoice.SerialNumber}" TabIndex="3" />
                <TextBlock Grid.Column="0" Grid.Row="2" Text="Dátum" Margin="0,5,5,5"/>
                <DatePicker Grid.Column="1" Grid.Row="2" SelectedDate="{Binding Invoice.IssueDate}" TabIndex="4" />
                <TextBlock Grid.Column="2" Grid.Row="2" Text="Fizetési mód" Margin="10,5,5,5"/>
                <ComboBox Grid.Column="3" Grid.Row="2" ItemsSource="{Binding PaymentMethods}" SelectedItem="{Binding Invoice.PaymentMethod}" TabIndex="5" />
                <TextBlock Grid.Column="0" Grid.Row="3" Text="Számítás módja" Margin="0,5,5,0"/>
                <ComboBox Grid.Column="1" Grid.Row="3" ItemsSource="{Binding CalculationModes}" SelectedIndex="0" TabIndex="6" />
            </Grid>
            <!-- Item buttons -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10" >
                <Button Content="Sor hozzáadása" Command="{Binding AddItemCommand}" Margin="0,0,10,0" />
                <Button Content="Sor módosítása" Command="{Binding EditItemCommand}" Margin="0,0,10,0" />
                <Button Content="Sor törlése" Command="{Binding DeleteItemCommand}" />
            </StackPanel>
            <!-- Item grid -->
            <DataGrid Grid.Row="2" ItemsSource="{Binding Invoice.Items}" AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Termék" Binding="{Binding Product.Name}" />
                    <DataGridTextColumn Header="Mennyiség" Binding="{Binding Quantity}" />
                    <DataGridTextColumn Header="Egység" Binding="{Binding Unit.Name}" />
                    <DataGridTextColumn Header="Egységár" Binding="{Binding UnitPriceNet}" />
                    <DataGridTextColumn Header="ÁFA %" Binding="{Binding VatRatePercent}" />
                    <DataGridTextColumn Header="Nettó" Binding="{Binding Net}" />
                    <DataGridTextColumn Header="ÁFA" Binding="{Binding Vat}" />
                    <DataGridTextColumn Header="Bruttó" Binding="{Binding Gross}" />
                </DataGrid.Columns>
            </DataGrid>
            <!-- Summary zone -->
            <Grid Grid.Row="3" Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <DataGrid Grid.Column="0" ItemsSource="{Binding VatSummaries}" AutoGenerateColumns="False" HeadersVisibility="Column" CanUserAddRows="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ÁFA %" Binding="{Binding Rate}" />
                        <DataGridTextColumn Header="Nettó" Binding="{Binding Net}" />
                        <DataGridTextColumn Header="ÁFA" Binding="{Binding Vat}" />
                        <DataGridTextColumn Header="Bruttó" Binding="{Binding Gross}" />
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Column="1" Orientation="Vertical" Margin="20,0,0,0">
                    <TextBlock Text="Nettó összesen:"/>
                    <TextBlock Text="{Binding GrandTotals.Net}" FontSize="16" Foreground="Yellow"/>
                    <TextBlock Text="ÁFA összesen:"/>
                    <TextBlock Text="{Binding GrandTotals.Vat}" FontSize="16" Foreground="Yellow"/>
                    <TextBlock Text="Bruttó összesen:"/>
                    <TextBlock Text="{Binding GrandTotals.Gross}" FontSize="16" Foreground="Yellow"/>
                    <TextBlock Text="{Binding GrandTotals.AmountText}" FontSize="12"/>
                </StackPanel>
            </Grid>
        </Grid>

        <!-- Bottom buttons -->
        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10">
            <Button Content="Mentés" Command="{Binding SaveCommand}" Margin="0,0,5,0" />
            <Button Content="Nyomtatás" IsEnabled="False" Margin="0,0,5,0" />
            <Button Content="Archiválás" IsEnabled="False" Margin="0,0,5,0" />
            <Button Content="CSV" IsEnabled="False" Margin="0,0,5,0" />
            <Button Content="Excel" IsEnabled="False" Margin="0,0,5,0" />
            <Button Content="PDF" IsEnabled="False" Margin="0,0,5,0" />
            <Button Content="Bezárás" Command="{Binding ExitToListCommand}" />
        </StackPanel>
    </Grid>
</Window>
